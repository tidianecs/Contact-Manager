<div class="bg-white h-0.5 w-full"></div>

<aside class="hidden md:flex md:flex-col md:w-72 md:h-[calc(100vh-4rem)] md:bg-slate-900 md:text-white md:p-4 md:shrink-0">
  <div class="mb-4">
    <input
      [(ngModel)]="searchTerm"
      type="text"
      placeholder="Rechercher un contact..."
      class="w-full rounded-lg p-2 bg-slate-600 text-sm text-white focus:outline-none focus:ring focus:ring-blue-400">
  </div>

  <div class="flex-1 overflow-y-auto space-y-3">
    <div
      *ngFor="let contact of filterContacts((contacts$ | async) || []); trackBy: trackById"
      (click)="chooseContact(contact.contactId!)"
      class="bg-white text-slate-900 rounded-xl p-3 shadow hover:bg-slate-700 hover:text-white flex items-center justify-between cursor-pointer ease-out duration-300 group">
      <h3 class="text-sm font-semibold truncate max-w-[11rem]">{{ contact.contactName }}</h3>

      <button
        class="opacity-0 group-hover:opacity-100 size-7 bg-red-500 rounded-md text-white grid place-items-center hover:shadow-md hover:shadow-black transition"
        (click)="deleteContact(contact.contactId!, $event)"
        aria-label="Delete">
        🗑️
      </button>
    </div>
  </div>
</aside>

<ng-container *ngIf="open">
  <div class="fixed inset-0 bg-black/40 z-40 md:hidden" (click)="close.emit()"></div>
  <aside class="fixed inset-y-0 left-0 w-72 bg-slate-900 text-white p-4 z-50 md:hidden">
    <div class="mb-4 flex items-center justify-between">
      <span class="font-semibold">Contacts</span>
      <button class="p-2 rounded hover:bg-slate-800" (click)="close.emit()" aria-label="Close">✕</button>
    </div>

    <div class="mb-4">
      <input
        [(ngModel)]="searchTerm"
        type="text"
        placeholder="Rechercher un contact..."
        class="w-full rounded-lg p-2 bg-slate-600 text-sm text-white focus:outline-none focus:ring focus:ring-blue-400">
    </div>

    <div class="h-[calc(100vh-9rem)] overflow-y-auto space-y-3">
      <div
        *ngFor="let contact of filterContacts((contacts$ | async) || []); trackBy: trackById"
        (click)="chooseContact(contact.contactId!)"
        class="bg-white text-slate-900 rounded-xl p-3 shadow hover:bg-slate-700 hover:text-white flex items-center justify-between cursor-pointer ease-out duration-300">
        <h3 class="text-sm font-semibold truncate max-w-[11rem]">{{ contact.contactName }}</h3>

        <button
          class="size-7 bg-red-500 rounded-md text-white grid place-items-center active:scale-95"
          (click)="deleteContact(contact.contactId!, $event)"
          aria-label="Delete">
          🗑️
        </button>
      </div>
    </div>
  </aside>
</ng-container>
